%!TEX TS-program = xelatex
\documentclass[12pt, a4paper, oneside]{article}

\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools}  % пакеты для математики

\usepackage[english, russian]{babel} % выбор языка для документа
\usepackage[utf8]{inputenc} % задание utf8 кодировки исходного tex файла
\usepackage[X2,T2A]{fontenc}        % кодировка

\usepackage{fontspec}         % пакет для подгрузки шрифтов
\setmainfont{Linux Libertine O}   % задаёт основной шрифт документа

\usepackage{unicode-math}     % пакет для установки математического шрифта
\setmathfont[math-style=upright]{Neo Euler} % шрифт для математики

% Конкретный символ из конкретного шрифта
% \setmathfont[range=\int]{Neo Euler}


%%%%%%%%%% Работа с картинками %%%%%%%%%
\usepackage{graphicx}                  % Для вставки рисунков
\usepackage{graphics}
\graphicspath{{images/}{pictures/}}    % можно указать папки с картинками
\usepackage{wrapfig}                   % Обтекание рисунков и таблиц текстом

%%%%%%%%%%%%%%%%%%%%%%%% Графики и рисование %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{tikz, pgfplots}  % язык для рисования графики из latex'a

%%%%%%%%%% Гиперссылки %%%%%%%%%%
\usepackage{xcolor}              % разные цвета

\usepackage{hyperref}
\hypersetup{
	unicode=true,           % позволяет использовать юникодные символы
	colorlinks=true,       	% true - цветные ссылки, false - ссылки в рамках
	urlcolor=blue,          % цвет ссылки на url
	linkcolor=red,          % внутренние ссылки
	citecolor=green,        % на библиографию
	pdfnewwindow=true,      % при щелчке в pdf на ссылку откроется новый pdf
	breaklinks              % если ссылка не умещается в одну строку, разбивать ли ее на две части?
}


\usepackage{todonotes} % для вставки в документ заметок о том, что осталось сделать
% \todo{Здесь надо коэффициенты исправить}
% \missingfigure{Здесь будет Последний день Помпеи}
% \listoftodos --- печатает все поставленные \todo'шки

\usepackage[paper=a4paper, top=20mm, bottom=15mm,left=20mm,right=15mm]{geometry}
\usepackage{indentfirst}       % установка отступа в первом абзаце главы

\usepackage{setspace}
\setstretch{1.15}  % Межстрочный интервал
\setlength{\parskip}{4mm}   % Расстояние между абзацами
% Разные длины в латехе https://en.wikibooks.org/wiki/LaTeX/Lengths


\usepackage{xcolor} % Enabling mixing colors and color's call by 'svgnames'

\definecolor{MyColor1}{rgb}{0.2,0.4,0.6} %mix personal color
\newcommand{\textb}{\color{Black} \usefont{OT1}{lmss}{m}{n}}
\newcommand{\blue}{\color{MyColor1} \usefont{OT1}{lmss}{m}{n}}
\newcommand{\blueb}{\color{MyColor1} \usefont{OT1}{lmss}{b}{n}}
\newcommand{\red}{\color{LightCoral} \usefont{OT1}{lmss}{m}{n}}
\newcommand{\green}{\color{Turquoise} \usefont{OT1}{lmss}{m}{n}}

\usepackage{titlesec}
\usepackage{sectsty}
%%%%%%%%%%%%%%%%%%%%%%%%
%set section/subsections HEADINGS font and color
\sectionfont{\color{MyColor1}}  % sets colour of sections
\subsectionfont{\color{MyColor1}}  % sets colour of sections

%set section enumerator to arabic number (see footnotes markings alternatives)
\renewcommand\thesection{\arabic{section}.} %define sections numbering
\renewcommand\thesubsection{\thesection\arabic{subsection}} %subsec.num.

%define new section style
\newcommand{\mysection}{
	\titleformat{\section} [runin] {\usefont{OT1}{lmss}{b}{n}\color{MyColor1}} 
	{\thesection} {3pt} {} } 


%	CAPTIONS
\usepackage{caption}
\usepackage{subcaption}
%%%%%%%%%%%%%%%%%%%%%%%%
\captionsetup[figure]{labelfont={color=Turquoise}}

\pagestyle{empty}

%%%%%%%%%% Свои команды %%%%%%%%%%
\usepackage{etoolbox}    % логические операторы для своих макросов

% Все свои команды лучше всего определять не по ходу текста, как это сделано в этом документе, а в преамбуле!

% Одно из применений - уничтожение какого-то куска текста!
\newbool{answers}
\booltrue{answers}
%\boolfalse{answers}

% бульпоинты в списках
\definecolor{myblue}{rgb}{0, 0.45, 0.70}
\newcommand*{\MyPoint}{\tikz \draw [baseline, fill=myblue,draw=blue] circle (2.5pt);}
\renewcommand{\labelitemi}{\MyPoint}



\begin{document}

\section*{Семинар 3-4:  привлечение клиентов и классификация}

\subsection*{Задача 0}

Ликбез!  Со всей глубиной и знанием дела дайте ответы на следующие вопросы: 

\begin{itemize}
\item  Почему нумерация в этом семинаре начинается с нуля? 
\item  Что такое машинное обучение и что оно позволяет делать? 
\item  Что такое обучение без учителя и чем оно отличается от обучения с учителем? 
\item  Чем задача классификации отличается от задачи кластеризации? 
\item  Чем задача классификации отличается от задачи регрессии? 
\item  Как оценить модель? Что для этого нужно? 
\item Что такое метрика качества модели? Какие метрики вы знаете? Как правильно измерить качество модели? 
\item Что такое кросс-валидация?  Как объяснить это бабушке? 
\end{itemize}

В смысле не знаете? Мы целый модуль этим занимались! 


\subsection*{Задача 1}

Нам нужно научиться отделять пиццу от бургеров, а также котиков от пёсиков и от мышек. Проведите на картинках линии, которые отделят одни классы от других.  Да, это и есть машинное обучение. Но обычно кривые рисуем не мы, а компуктер.

\begin{minipage}[t]{0.45\textwidth}
	\includegraphics[scale=0.25]{class_1.png}
\end{minipage}
\hfill
\begin{minipage}[t]{0.45\textwidth}
	\includegraphics[scale=0.25]{class_2.png}
\end{minipage}

Почему нельзя провести между пиццей и бургерами слишком подробную и извилистую границу? В чём проблема самого правого верхнего котика? Что такое переобучение?  Как понять переобучились ли мы? 

\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}


\subsection*{Задача 2}

На плоскости расположены колонии рыжих и чёрных муравьёв. Рыжих колоний три и они имеют координаты $(-1, -1)$, $(1, 1)$ и $(3, 3)$. Чёрных колоний тоже три и они имеют координаты $(2, 2)$, $(4, 4)$ и $(6, 6)$.

\begin{enumerate}
	\item Чем KNN отличается от K-means? 
	\item Поделите плоскость на «зоны влияния» рыжих и чёрных используя метод одного ближайшего соседа.
	\item Поделите плоскость на «зоны влияния» рыжих и чёрных используя метод трёх ближайших соседей.
	\item С помощью кросс-валидации с выкидыванием отдельных наблюдений выберите оптимальное число соседей $k$ перебрав $k \in \{1, 3, 5\}$. Целевой функцией является количество несовпадающих прогнозов.
\end{enumerate}


\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}



\subsection*{Задача 3}

Машка пять дней подряд гадала на ромашке, а затем выкладывала очередную фотку «Машка с ромашкой» в инстаграмчик. Результат гадания — переменная $y_i$, количество лайков у фотки — переменная $x_i$. Постройте классификационное дерево для прогнозирования $y_i$ с помощью $x_i$ на обучающей выборке:

\begin{center}
\begin{tabular}{cc}
	$y_i$ & $x_i$ \\
	\hline
	плюнет & $10$ \\
	поцелует & $11$ \\
	поцелует & $12$ \\
	к сердцу прижмёт & $13$ \\
	к сердцу прижмёт & $14$ \\
\end{tabular}
\end{center}

Дерево строится до идеальной классификации. Критерий деления узла на два — минимизация числа допущенных ошибок\footnote{На самом деле на практике так не делают. Обычно для разбиения узла при строительстве классификационных деревьев используют энтропию. О том что это такое, можно погуглить.}.  Правило прогнозирования в каждой вершине: в качестве прогноза выдаем тот класс, представителей которого в вершине больше.  Предположим, что под фоткой стоит 15 лайков, каков будет результат гадания? 


\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}




\subsection*{Задача 4}

По данной диаграмме рассеяния постройте классификационное дерево для зависимой переменной $y$:

	\begin{center}
		\begin{tikzpicture}[scale = 0.015]
		\input{images/tree_scatter_data.tikz}
		\end{tikzpicture}
	\end{center}


\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}



\subsection*{Задача 5}

Предположим, что мы собираемся выпустить на рынок новое приложение. Нам хотелось бы,  чтобы оно привлекло как можно больше пользователей и постоянно оставалось популярным. Предположим, что у нас в руках есть выборка о том, какие приложения есть в данный момент в App Store, какими они обладают параметрами и какой у них рейтинг. 

\begin{enumerate} 
	\item Как можно было бы использовать эту выборку? 
	\item Какие подводные камни нас, скорее всего, ожидают? 
\end{enumerate}


\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}



\section{Ещё задачи} 

\subsection*{Задача 6}

Пятачок собрал данные о визитах Винни-Пуха в гости к Кролику. Здесь $x_i$ - количество съеденного мёда в горшках, а $y_i$  - бинарная переменная, отражающая застревание Винни-Пуха при входе 

\begin{center}
	\begin{tabular}{c|c}
		$y_i$ & $x_i$ \\
		\hline
		0  & 1 \\
		1 & 4\\
		1 & 2\\
		0 & 3 \\
		1 & 3 \\
		0 & 1
	\end{tabular}
\end{center}

Пятачок собирается оценить дерево. Он хочет проверить его прогнозную силу с помощью кросс-валидации с выкидывание отдельных  наблюдений. Целевой функцией является количество несовпадающих прогнозов. Помогите очень маленькому существу оценить предиктивную силу его модели.


\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}



\subsection*{Задача 7} 

Ниже изображены разделяющие поверхности для задачи бинарной классификации, соответствующие решающим деревьям разной глубины. Какое из изображений соответствует наиболее глубокому дереву?

\begin{center}
	\includegraphics[scale=0.7]{trees.png}
\end{center}


\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}



\subsection*{Задача 8} 

Рассмотрим обучающую выборку для прогнозирования $y$ с помощью $x$ и $z$:

\begin{center}
\begin{tabular}{c|c|c}
	$y_i$ & $x_i$ & $z_i$ \\
\hline
	$y_1$ & $1$ & $2$ \\
	$y_2$ & $1$ & $2$ \\
	$y_3$ & $2$ & $2$ \\
	$y_4$ & $2$ & $1$\\
	$y_5$ & $2$ & $1$ \\
	$y_6$ & $2$ & $1$ \\
	$y_7$ & $2$ & $1$ \\
\end{tabular}
\end{center}

Будем называть деревья разными, если они выдают разные прогнозы на обучающей выборке.
Сколько существует разных классификационных деревьев  для данного набора данных?


\ifbool{answers}{
	\textbf{Решение:}
	
	
	
	
}



\end{document}
