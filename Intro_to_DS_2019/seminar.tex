%!TEX TS-program = xelatex
\documentclass[12pt, a4paper, oneside]{article}

\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools}  % пакеты для математики

\usepackage[english, russian]{babel} % выбор языка для документа
\usepackage[utf8]{inputenc} % задание utf8 кодировки исходного tex файла
\usepackage[X2,T2A]{fontenc}        % кодировка

\usepackage{fontspec}         % пакет для подгрузки шрифтов
\setmainfont{Linux Libertine O}   % задаёт основной шрифт документа

\usepackage{unicode-math}     % пакет для установки математического шрифта
\setmathfont[math-style=upright]{Neo Euler} % шрифт для математики


%%%%%%%%%% Работа с картинками %%%%%%%%%
\usepackage{graphicx}                  % Для вставки рисунков
\usepackage{graphics}
\graphicspath{{images/}{pictures/}}    % можно указать папки с картинками
\usepackage{wrapfig}                   % Обтекание рисунков и таблиц текстом

%%%%%%%%%% Для таблиц   %%%%%%%%%%%%%
\usepackage{booktabs}            % таблицы как в книгах!  


%%%%%%%%%%%%%%%%%%%%%%%% Графики и рисование %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{tikz, pgfplots}  % язык для рисования графики из latex'a

%%%%%%%%%% Гиперссылки %%%%%%%%%%
\usepackage{xcolor}              % разные цвета

\usepackage{hyperref}
\hypersetup{
	unicode=true,           % позволяет использовать юникодные символы
	colorlinks=true,       	% true - цветные ссылки, false - ссылки в рамках
	urlcolor=blue,          % цвет ссылки на url
	linkcolor=red,          % внутренние ссылки
	citecolor=green,        % на библиографию
	pdfnewwindow=true,      % при щелчке в pdf на ссылку откроется новый pdf
	breaklinks              % если ссылка не умещается в одну строку, разбивать ли ее на две части?
}


\usepackage{todonotes} % для вставки в документ заметок о том, что осталось сделать
% \todo{Здесь надо коэффициенты исправить}
% \missingfigure{Здесь будет Последний день Помпеи}
% \listoftodos --- печатает все поставленные \todo'шки

\usepackage[paper=a4paper, top=20mm, bottom=15mm,left=20mm,right=15mm]{geometry}
\usepackage{indentfirst}       % установка отступа в первом абзаце главы

\usepackage{setspace}
\setstretch{1.15}  % Межстрочный интервал
\setlength{\parskip}{4mm}   % Расстояние между абзацами
% Разные длины в латехе https://en.wikibooks.org/wiki/LaTeX/Lengths


\usepackage{xcolor} % Enabling mixing colors and color's call by 'svgnames'

\definecolor{MyColor1}{rgb}{0.2,0.4,0.6} %mix personal color
\newcommand{\textb}{\color{Black} \usefont{OT1}{lmss}{m}{n}}
\newcommand{\blue}{\color{MyColor1} \usefont{OT1}{lmss}{m}{n}}
\newcommand{\blueb}{\color{MyColor1} \usefont{OT1}{lmss}{b}{n}}
\newcommand{\red}{\color{LightCoral} \usefont{OT1}{lmss}{m}{n}}
\newcommand{\green}{\color{Turquoise} \usefont{OT1}{lmss}{m}{n}}

\usepackage{titlesec}
\usepackage{sectsty}
%%%%%%%%%%%%%%%%%%%%%%%%
%set section/subsections HEADINGS font and color
\sectionfont{\color{MyColor1}}  % sets colour of sections
\subsectionfont{\color{MyColor1}}  % sets colour of sections

%set section enumerator to arabic number (see footnotes markings alternatives)
\renewcommand\thesection{\arabic{section}.} %define sections numbering
\renewcommand\thesubsection{\thesection\arabic{subsection}} %subsec.num.

%define new section style
\newcommand{\mysection}{
	\titleformat{\section} [runin] {\usefont{OT1}{lmss}{b}{n}\color{MyColor1}} 
	{\thesection} {3pt} {} } 


%	CAPTIONS
\usepackage{caption}
\usepackage{subcaption}
%%%%%%%%%%%%%%%%%%%%%%%%
\captionsetup[figure]{labelfont={color=Turquoise}}

\pagestyle{empty}


%%%%%%%%%% Свои команды %%%%%%%%%%
\usepackage{etoolbox}    % логические операторы для своих макросов

% Все свои команды лучше всего определять не по ходу текста, как это сделано в этом документе, а в преамбуле!

% Одно из применений - уничтожение какого-то куска текста!
\newbool{answers}
\booltrue{answers}
%\boolfalse{answers}

\newbool{addanswers}
\boolfalse{addanswers}

\usepackage{enumitem}
% бульпоинты в списках
\definecolor{myblue}{rgb}{0, 0.45, 0.70}
\newcommand*{\MyPoint}{\tikz \draw [baseline, fill=myblue,draw=blue] circle (2.5pt);}
\renewcommand{\labelitemi}{\MyPoint}

% расстояние в списках
\setlist[itemize]{parsep=0.4em,itemsep=0em,topsep=0ex}
\setlist[enumerate]{parsep=0.4em,itemsep=0em,topsep=0ex}

\begin{document}

\section*{Семинар 4: основы статистики! }

Обсудили до задачки: 

\begin{itemize}
	\item  Что такое распределение, что такое гистограмма 
	
	\item Меры центральности: среднее, медиана, мода 
	
	\item Меры разброса: размах, дисперсия, среднее квадратичное отклонение
	
	\item 
	
\end{itemize}


\subsection*{Задача 1}

В табличке ниже дано целых 10 наблюдений.  

\begin{center}
\begin{tabular}{@{}lllll@{}}
	\toprule
	имя & пол  & возраст  & вес & рост  \\ \midrule
	& м  & $14$ &  &  \\
	& ж & $16$ &  &  \\
	& ж & $20$ &  &  \\
	& м & $20$ &  &  \\
	& м & $14$ &  &  \\
	& ж & $25$ &  &  \\
	& м & $30$ &  &  \\
	& ж & $23$ &  &  \\
	& м & $22$ &  &  \\
	& м & $16$  &  &  \\ \bottomrule
\end{tabular}	
\end{center}


Что нужно сделать : 

\begin{enumerate}
	\item[а)] Что такое непрерывная переменная? Что такое категориальная переменная? Какие переменные в табличке относятся к непрерывным? Какие к категориальным? 
	
	\item[б)]  Постройте для пола гистограмму.  Ченить спизданите про неё 
	
	\item[б)]  Постройте для возраста гистограмму.  Ченить спизданите про неё 

	\item[в)] Найдите средний возраст и медианный возраст. Отметьте их на гистограмме. Что означают эти числа. В чём они измеряются? 
	
	\item[г)] Найдите дисперсию возраста. В чём измеряются эта величина? Зачем обычно ищут среднее квадратическое отклонение? Найдите его. 
	
	\item[д)] Что такое выброс? Есть ли выбросы в возрасте или весе? Как выглядит выброс на гистограмме? Найдите средний вес и медианный вес. Чем медиана в данном случае лучше, чем среднее?
	
	\item[е)] Чувствительна ли дисперсия к выбросам?
	
	\item[ж)] Что такое мода? Почему использовать её для непрерывных переменных не очень хорошая идея? Найдите моду для имени, пола и возраста.  (уточнить что это дискретная мода и тп) 
		
	\item[з)]  ченить в стиле как измерть среднее для категориальных переменных. Вопрос про доли, моду. 
	
	\item[и)]  Что такое квантиль? Предложите способ, который помог бы избавиться от выбросов. 	
\end{enumerate}





\textbf{Решение:} 

\begin{enumerate}
\item[а)] Что такое непрерывная переменная? Что такое категориальная переменная? Какие переменные в табличке относятся к непрерывным? Какие к категориальным? 

\item[б)]  Посчитаем с какой частотой в выборке встречаются мужчины и с какой женщины.  В выборке $6$ мужчин и $4$ женщины. 




\item[б)]  Постройте для возраста гистограмму.  Ченить спизданите про неё 

\item[в)] 

Найдём средний возраст. Для этого сложим все числа и поделим их на количество наблюдений

\[
\frac{1}{10} \cdot (14 + 16 + 20 + 20 + 14 + 25 + 30 + 23 + 22 + 16) = 20.
\]

Средний возраст это $20$ лет.  Формула для подсчёта среднего выглядела как 

\[
\bar x = \frac{1}{n} (x_1 + \ldots + x_n) = \frac{1}{n} \sum_{i=1}^n x_i.
\]

Привыкайте к формулам. Они будут часто встречаться вам по жизни. 

Чтобы найти медиану нам нужно упорядочить всех людей из выборки по возрасту и посмотреть на середину получившегося ряда. 

\[
14 \quad 14  \quad 16  \quad 16  \quad {\color{myblue}{20}}  \quad {\color{myblue}{20}}  \quad 22  \quad 23  \quad 25  \quad 30
\]

У нас в середине находятся сразу два человека. Медианой будет их среднее, то есть $20$ лет. Грубо говоря, половина нашей выборки оказывается слева от этого числа, а вторая справа. Медиана находится в серединке. 

Отметим оба значения на гистограмме. 

\todo[inline]{Отметить}



\item[г)] Найдите дисперсию возраста. В чём измеряются эта величина? Зачем обычно ищут среднее квадратическое отклонение? Найдите его. 

Дисперсия --- это мера разброса. Она показывает насколько разнообразными могут быть элементы в выборке. 

Чтобы найти её, нужно посмотреть насколько сильно каждый представитель в выборке отличается от текущего. Величина такого отличия называется отклонением. Предположим, что Алёне $18$ лет. Карине $22$ года. Тогда отклонением для Алёны от среднего возраста будет $18 - 20 = -2$ года. Для Карины отклонением будет $22 - 20 = 2$ года. 

Если просуммировать эти отклонения, мы получим $-2 + 2 = 0$. То есть в выборке нет никакого разброса. Все не отличаются от среднего. Это неправда. Для того, чтобы избежать неправды и жить по правде, отклонения возводят в квадрат. Тогда, мы получаем, что суммарное отклонение будет $-2^2 + 2^2 = 4 + 4 = 8$. Посмотрев на такое число мы сразу же поймём, что в выборке есть неоднородность. 

Среднее значение квадратов отклонений от среднего и называется дисперсией. Давайте найдём её. Ещё раз выпишем наши наблюдения: 

\[
14 \quad 14  \quad 16  \quad 16  \quad 20  \quad 20  \quad 22  \quad 23  \quad 25  \quad 30
\]

Сначала из каждого вычитаем среднее. Это даст нам вектор 

\[
-6 \quad -6  \quad -4  \quad -4  \quad 0  \quad 0 \quad 2  \quad 3  \quad 5  \quad 10.
\]

Теперь возводим все отклонения в квадрат

\[
36 \quad 36  \quad 16  \quad 16 \quad 0  \quad 0 \quad 4  \quad 9 \quad 25  \quad 100.
\]

Складываем их! Получается $242$. Остаётся разделить это число на количество наблюдений, $10$.

Получается, что дисперсия составит $24.2$ квадратных года.  Из-за того, что мы каждое слагаемое возводили в квадрат, дисперсия измеряется в квадратных годах.  

Когда мы умножаем одну сторону квадрата на другую, мы получаем его площадь. Она измеряется в квадратных метрах. Тут похожая ситуация. Мы бы хотели вернутся назад, к обычным годам. Для этого из дисперсии извлекают корень и получают штуку под названием стандартное отклонение.  В нашем случае получится $4.9$ года. 

Здесь нам осталось обсудить пару нюансов. 

\begin{itemize}
	\item  Мы возводим отклонения в квадрат не только для того, чтобы сделать все числа положительными. Попутно мы подчёркиваем, что чем больше отклоняется возраст от среднего, тем это хуже. Так штраф за отклонение в два года составит $4$, а за отклонение в три года, $9$.  С подобное логикой мы ещё встретимся, когда будем обсуждать различные метрики, используемые в машинном обучении. 
	
	\item Часто при подсчёте дисперсии вместо формулы 
	
	\[ 
	\sigma^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \bar x)^2,
	\]
	
	которую использовали мы, используют 
	
	\[ 
	\sigma^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar x).
	\]
	
	Вторая формула на самом деле корректнее, чем первая.  В питоне используется именно она. У этого есть глубокие причины. В полной мере их вы узнаете в курсе по математической статистике. Мы вкратце скажем об этом ближе к концу курса, когда будем говорить про АБ-тесты. Пока держите это в голове, как вопрос, на который у вас нет ответа. Надеюсь, что это будет как следует мучать вас по ночам и стимулировать ботать. 
	
	\item Как правило, большая часть выборки, а именно $69\%$ кучкуется в диапазоне между $\bar x - \sigma$ и $\bar x + \sigma$.  
	
	При этом $95 \%$ выборки находится между $\bar x - 2 \cdot \sigma$ и $\bar x + 2 \cdot \sigma$, а $99.9\%$ выборки находятся между $\bar x - 3 \cdot \sigma$ и $\bar x + 3 \cdot \sigma$. 
	
	Так обычно происходит, если признак имеет нормальное распределение. Правила таких кучкований называют правилом одной, двух и трёх сигм. Их часто используют для проведения АБ-тестов. Об этом мы поговорим ближе к концу курса. Попомните моё слово. 
	
	\todo[inline]{картинка с правилом 3-х сигм}
\end{itemize}


\item[д)] Что такое выброс? Есть ли выбросы в возрасте или весе? Как выглядит выброс на гистограмме? Найдите средний вес и медианный вес. Чем медиана в данном случае лучше, чем среднее?

\todo[inline]{рассчёты! картинка гистограммы с выбросами}


Среди наших элементов оказался выброс. Он существенно сдвинул среднее значение в большую сторону. Из-за этого оно перестало отражать типичный вес человека из выборки. Наше представление о людях оказалось искажено. 

Медиана в отличие от среднего оказывается нечувствительна к выбросам. Это происходит из-за способа её поиска. Мы упорядочиваем наблюдения по порядку и смотрим на то, какое в середине. Значение выброса никак не участвует в подсчёте медианы и именно из-за этого не искажает её. 

. 
\item[е)] Чувствительна ли дисперсия к выбросам?

К несчастью, да. 

\item[ж)] Что такое мода? Почему использовать её для непрерывных переменных не очень хорошая идея? Найдите моду для имени, пола и возраста.  (уточнить что это дискретная мода и тп) 

Чтобы найти моду, мы должны найти самое часто встречаемое значение. Для непрерывной переменной это не очень хорошая затея. 

про возраст 


\item[з)]  ченить в стиле как измерть среднее для категориальных переменных. Вопрос про доли, моду. 

\item[и)]  Что такое квантиль? Предложите способ, который помог бы избавиться от выбросов. 	

Объяснения про квантиль! 

Как мы выяснили выше, выбросы могут существенным образом искажать наши представления о выборке. От них нужно выборку очищать. Один из способов: отрубить все наблюдения, которые находятся выше $99\%$ квантиля и все наблюдения, которы находятся ниже $1\%$ квантиля. На гистограмме такой подходит выглядит как-то вот так: 

\todo[inline]{Борьбу с выбросами нарисовать}

\end{enumerate}





\subsection*{Задача 1}

Корреляции - ??? 





\section*{Ещё задачи!} 

\subsection*{Задача 1}

Имеется пять чисел: $x$, $9$, $5$, $4$, $7$. При каком значении x медиана будет равна среднему?
 
 \textbf{Решение:} 
 
 Расположим числа в порядке возрастания: $4,5,7,9$. В зависимости от расположения $x$ меняется медиана. Так, если мы воткнём $x$ перед или сразу после $4$, медианой будет $5$. Если воткнуть $x$ после $5$, то сам $x$ будет медианой. Если воткнуть $x$ в конце или перед $9$, то медианой окажется $7$. 
 
 Составим три уравнения: 
 
\begin{equation*} 
\begin{aligned}
	& \frac{x + 4 + 5 + 7 + 9}{5} = 5 \Rightarrow x = 0 \\
	& \frac{4 + 5 + x + 7 + 9}{5} = x \Rightarrow x = 6.25 \\
	& \frac{4 + 5 + 7 + 9 + x}{5} = 7 \Rightarrow x = 10 \\
\end{aligned}
\end{equation*}

\todo[inline]{А можно ли поставить такие цифры в условии задачи, чтобы $x$ не существовал?}



\subsection*{Задача 2}

Измерен рост 25 человек. Средний рост оказался равным 160 см. Медиана оказалась равной 155 см. Машин рост в 163 см был ошибочно внесен как 173 см. Как изменится медиана и среднее после исправления ошибки? А как могут измениться медиана и среднее, если рост Маши равен 153?

 \textbf{Решение:} 

Если рост Маши ошибочно был внесен как 173 см вместо 163, то при исправлении ошибки изменения никак не отразятся на медиане, потому что ошибочно внесенный рост и ее рост больше медианы. Средний рост уменьшится.


\subsection*{Задача 3}

Деканат утверждает, что если студента N перевести из группы А в группу В,то средний рейтинг каждой группы возрастет. Возможно ли такое?

 \textbf{Решение:} 

Да, возможно. Если средняя оценка N ниже средней оценки группы А, но выше средней в группе В, то после смены студентом группы средняя оценка каждой группы и ее рейтинг возрастут.

Например, группы А и В состоят из 3 человек, которые имеют оценки 8, 9, 10 и 1, 2, 3 соответственно. Студент N, имеющий гценку 8, желает перейти в группу В. Тогда изменения оценки группы А = (9+10)/2 - (9+10+8)/3 = 0.5, то есть рейтинг группы повысится; изменения для группы В: (1+2+3+8)/4 - (1+2+3)/3 = 1.5, а значит рейтинг группы В тоже повысится.


\subsection*{Задача 4} 

Иногда в качестве меры разброса используют размах. Находят максимальное значение в выборке, минимальное значение выборке, а после вычитают из максимума минимум. Как думаете, такая мера чувствительна к выбросам? Как можно сделать её устойчивой к ним? (интерквантильный размах).


\newpage

\section*{Семинар про АБ-тесты }

\subsection*{Задача 1} 

Скарлет, Сьюлин и Кэррин исследуют рост людей в Атланте. 

Аристарх,  Маша и Паша исследуют рост людей. 

Три исследователя, все исследуют рост людей. Сделали три выборки. 

Илья занимается баскетболом, поэтому он переписал из журнала тренера рост членов команды

Маша измеряет рост людей на остановке, пока те ждут автобус. 

Паша ещё чет делает не оч стабильное. Рост девушек пока они спят в его кровати - ???


У кого из исследователей получится репрезентативная выборка? 





\subsection*{Задача 2} 

По всем 4 наблюдениям реально равно. 

4 наблюдения всего в генеральной совокупности.  Мы хотим проверить равно ли оно чему-то.  Для этого делаем два наблюдения и смотрим равно ли. 

мы делаем два наблюдения и считаем среднее. Если равно да, если не равно нет. 

В реальности равно. Как нам получить правильные выводы, если все 4 наблюдения мы никогда не можем собрать. 

Построить распределение среднего. Отсюда родить статистический критерий для среднего.  Типо если не сильно отклоняется ок, сильно не ок. Плавно перейти к ЦПТ отсюда. 


что-нибудь с монеткой


\subsection*{Задача 3} 

Проверить какую-нибудь гипотезу через правило трёх сигм и нормальное распределение про среднее. 


\subsection*{Задача 4} 



\subsection*{Задача 5} 


\subsection*{Задача 6} 

Во время Второй Мировой войны американские военные собрали статистику попаданий пуль в фюзеляж самолёта. По самолётам, вернувшимся из полёта на базу, была составлена карта повреждений среднестатистического самолёта. С этими данными военные обратились к статистику Абрахаму Вальду с вопросом, в каких местах следует увеличить броню самолёта.
Что посоветовал Абрахам Вальд и почему?



 Профессор, я решал эту задачу 3 часа, а ответ не совпадает. Где я сделал ошибку? — Предположив, что ответы к задачнику верные.



\subsection*{Задачка 0 (в которой мы разгоняем сомнения)}

\begin{itemize}
	\item  Как Сергею понять где кофе любят больше? 
	\item Как Акулине правильно провести АБ-тест своего снадобья? 
\end{itemize}


\subsection*{Задачка 0 (в которой сомнение селится в наших головах)}

\begin{itemize}
	\item  Хипстер Сергей пристаёт на улице к людям со странными вопросами. Он опросил в Питере и Москве по сто человек. Каждому он задавал вопрос: "Кофе любишь?"  В Москве "Да" сказали $50$ человек, в Питере $55$ человек. Можно ли исходя из этого сделать вывод, что в Питере кофе любят больше? 
	
	\item Знахарка Акулина смешала в тазике "доктор Мом" с соком редьки. Этот настой она дала простудившейся внучке. Внучка выздоровела. Означает ли это, что лекарство работает? Предположим, что знахарка дала своё "лекарство" пяти простуженным внучкам. Три из них выздоровели, две нет. Означает ли это, что лекарство в большей части случаев помогает? 
\end{itemize}


\end{document}
